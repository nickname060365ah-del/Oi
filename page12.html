<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>แจกคอมมาน — By Pain</title>
  <style>
    :root{
      --bg:#0e0e0e; --panel:#0f0f0f; --card:#111213; --line:#222;
      --muted:#9aa0a6; --accent:#4da3ff; --white:#fff; --press:#232428;
      --transition:.22s cubic-bezier(.2,.9,.2,1);
      --topbar-h:64px; --max-width:1100px;
    }

    /* Reset & base */
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--white);font-family:Inter,system-ui,"Segoe UI",Tahoma,Arial,sans-serif;-webkit-font-smoothing:antialiased}
    a{color:inherit;text-decoration:none}
    button{font:inherit;background:transparent;border:0;color:inherit;cursor:pointer}
    * { -webkit-tap-highlight-color: transparent; }

    /* Topbar */
    .topbar{
      position:sticky; top:0; height:var(--topbar-h); z-index:600;
      background:var(--panel); border-bottom:1px solid var(--line);
      display:flex; align-items:center; gap:12px; padding:12px 14px;
    }
    .hamb{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:610}
    .hamb svg{width:22px;height:22px;fill:var(--white)}
    .brand{font-weight:800;font-size:20px;color:var(--accent);margin-left:6px}
    .spacer{flex:1}
    .header-img{width:46px;height:36px;border-radius:8px;border:2px solid rgba(255,255,255,0.06);background:rgba(255,255,255,0.02);display:flex;align-items:center;justify-content:center}

    /* Layout */
    .container{display:flex;min-height:calc(100vh - var(--topbar-h));position:relative}
    main.content{flex:1;padding:22px;max-width:var(--max-width);margin:0 auto;box-sizing:border-box}

    /* Overlay and sidebar */
    #mcOverlay{position:fixed;left:0;right:0;top:var(--topbar-h);bottom:0;background:rgba(0,0,0,0.45);opacity:0;pointer-events:none;transition:opacity .22s;z-index:350}
    #mcOverlay.show{opacity:1;pointer-events:auto}
    #mcSidebar{
      position:fixed; left:-100%; top:var(--topbar-h); height:calc(100% - var(--topbar-h));
      width:86vw; max-width:420px; background:var(--panel); box-shadow:2px 0 40px rgba(0,0,0,.6);
      z-index:400; padding:16px; transition:left var(--transition); overflow:auto; border-right:1px solid var(--line);
      border-radius:0 12px 12px 0;
    }
    #mcSidebar.open{left:0}

    /* Sidebar internal header (title + close) */
    .mc-menu-header{display:flex;align-items:center;justify-content:space-between;padding:6px 4px;margin-bottom:12px}
    .mc-menu-title{color:var(--accent);font-size:28px;font-weight:800}
    .mc-close{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.02);cursor:pointer}
    .mc-close svg{width:20px;height:20px;fill:var(--white);opacity:.95}

    .menu-list{list-style:none;padding:0;margin:0}
    .menu-item{padding:14px 6px;border-bottom:1px solid var(--line);display:flex;align-items:center;justify-content:space-between}
    .menu-item a{flex:1;font-size:18px;color:var(--white);padding-right:8px}
    .menu-item .chev{color:var(--muted);font-size:18px}

    /* Hero + Boxes */
    .hero{padding:18px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);margin-bottom:18px}
    .hero h1{font-size:clamp(26px,5.2vw,34px);margin:0 0 6px;color:var(--white)}
    .hero p{margin:0;color:var(--muted)}

    .tool-row{display:flex;gap:10px;align-items:center;margin:12px 0 18px;flex-wrap:wrap}
    .search{display:flex;align-items:center;background:var(--card);padding:8px 10px;border-radius:12px;border:1px solid var(--line);min-width:160px;flex:1}
    .search input{background:transparent;border:0;color:var(--white);width:100%;font-size:15px;padding:6px 0}
    .select{background:var(--card);padding:8px 12px;border-radius:12px;border:1px solid var(--line);min-width:120px;color:var(--muted)}

    /* download button style (professional) */
    .download-btn{
      background: rgb(59,130,246); color:#fff; border-radius:14px; padding:12px 18px; font-weight:600; min-width:110px;
      transition: background .2s ease, transform .15s ease, box-shadow .18s ease; position:relative; overflow:hidden; box-shadow:0 8px 24px rgba(59,130,246,0.12);
    }
    .download-btn:hover{background:rgb(37,99,235)}
    .download-btn:active{background:rgb(29,78,216); transform:scale(.96)}
    .download-btn .flash{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%) scale(1);width:90%;height:62%;border-radius:12px;background:rgba(255,255,255,0.12);opacity:0;pointer-events:none;transition:opacity .18s, transform .18s}
    .download-btn .flash.show{opacity:1; transform:translate(-50%,-50%) scale(.98)}

    .btn.ghost{background:transparent;border:1px solid var(--line);color:var(--white);padding:10px 14px;border-radius:12px}

    /* sections & code blocks */
    .section{margin-bottom:18px}
    .heading-row{display:flex;align-items:center;gap:8px;margin-bottom:8px}
    .section h3{font-size:18px;margin:0;color:var(--white);flex:1}
    .lead{color:var(--muted);margin:0 0 12px}
    .codewrap{background:#060606;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.02);overflow:auto}
    pre.cmd{margin:0;color:#e6eef8;background:transparent;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Roboto Mono, \"Courier New\",monospace;font-size:14px;line-height:1.5;white-space:pre-wrap;word-break:break-word}

    /* per-section copy button */
    .copy-section-btn{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      color:var(--white); border-radius:10px; padding:8px 10px; font-weight:600;
      border:1px solid rgba(255,255,255,0.03); cursor:pointer; display:inline-flex;align-items:center;gap:8px;min-width:96px;
      position:relative; overflow:hidden;
    }
    .copy-section-btn .flash{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%) scale(1);width:82%;height:56%;border-radius:10px;background:rgba(255,255,255,0.08);pointer-events:none;opacity:0;transition:opacity .15s,transform .15s}
    .copy-section-btn.pressed{transform:scale(.97)}
    .copy-section-btn .flash.show{opacity:1;transform:translate(-50%,-50%) scale(.98)}

    footer{padding:22px;text-align:center;color:var(--muted);border-top:1px solid var(--line);margin-top:18px}

    /* accessibility / remove outlines */
    :focus{outline:none}
  </style>
</head>
<body>
  <!-- topbar -->
  <div class="topbar" role="banner">
    <button class="hamb" id="mcHamb" aria-label="เปิดเมนู">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 6h18v2H3zM3 11h18v2H3zM3 16h18v2H3z"/></svg>
    </button>
    <div class="brand">MC Command</div>
    <div class="spacer" aria-hidden="true"></div>
    <div class="header-img" id="mcHeaderImg" title="ใส่รูปได้"></div>
  </div>

  <div class="container">
    <!-- overlay -->
    <div id="mcOverlay" aria-hidden="true"></div>

    <!-- sidebar -->
    <aside id="mcSidebar" aria-hidden="true" role="navigation">
      <div class="mc-menu-header">
        <div class="mc-menu-title">เมนู</div>
        <button class="mc-close" id="mcClose" aria-label="ปิดเมนู">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M18.3 5.71 12 12l6.3 6.29-1.41 1.42L12 13.41l-6.29 6.3L4.29 19.71 10.59 13.4 4.29 7.11 5.7 5.7 12 11.99z"/></svg>
        </button>
      </div>

      <ul class="menu-list">
        <li class="menu-item"><a href="index.html" target="_self">หน้าแรก</a><span class="chev">›</span></li>
        <li class="menu-item"><a href="commands.html" target="_self">คำสั่งทั้งหมด</a><span class="chev">›</span></li>
        <li class="menu-item"><a href="about.html" target="_self">เกี่ยวกับ</a><span class="chev">›</span></li>
      </ul>
    </aside>

    <!-- main content -->
    <main class="content" id="mcMain" role="main">
      <section class="hero" aria-labelledby="heroTitle">
        <div class="hero-inner">
          <h1 id="heroTitle">แจกคอมมานซื้อของ — By Pain</h1>
          <p>รวมคำสั่ง Minecraft Bedrock (แจกระบบซื้อของใน NPC) — จัดเป็นหมวด อ่านง่าย ก๊อปได้จริง</p>
        </div>
      </section>

      <div class="tool-row">
        <div class="search" role="search">
          <svg style="width:16px;height:16px;opacity:.6;margin-right:8px" viewBox="0 0 24 24"><path fill="currentColor" d="M9.5 3A6.5 6.5 0 1 1 3 9.5 6.507 6.507 0 0 1 9.5 3m0-2A8.5 8.5 0 1 0 18 9.5 8.509 8.509 0 0 0 9.5 1z"/><path fill="currentColor" d="M20.71 20.29l-4.4-4.39"/></svg>
          <input id="mcSearch" placeholder="ค้นหา... (เช่น give, tag, playsound)" aria-label="ค้นหา" />
        </div>

        <select id="mcFilter" class="select" aria-label="กรองหมวด">
          <option value="all">ทั้งหมด</option>
          <option value="chat">คำสั่งช่องแชท</option>
          <option value="cmdblock">คำสั่งคอมมานด์บล็อก</option>
          <option value="npc">คำสั่ง NPC</option>
        </select>

        <button id="mcDownload" class="download-btn" aria-label="ดาวน์โหลด">ดาวน์โหลด
          <span class="flash" aria-hidden="true"></span>
        </button>

        <button id="mcCopyAll" class="btn ghost" aria-label="คัดลอกทั้งหมด">คัดลอกทั้งหมด</button>
      </div>

      <!-- sections -->
      <section class="section" data-cat="chat" id="sec-chat">
        <div class="heading-row">
          <h3>คำสั่งในช่องแชท</h3>
          <button class="copy-section-btn" data-target="chatCommands">คัดลอก
            <span class="flash" aria-hidden="true"></span>
          </button>
        </div>
        <p class="lead">แนะนำก๊อปทีละคำสั่งแล้ววาง</p>
        <div class="codewrap">
<pre id="chatCommands" class="cmd">
/give @s command_block
/give @s spawn_egg 1 51
/gamerule commandblockoutput false
/gamerule sendcommandfeedback false
/tickingarea add circle ~~~ 4 t
/scoreboard objectives add m dummy

/tag @n[type=npc] add b
</pre>
        </div>
      </section>

      <section class="section" data-cat="cmdblock" id="sec-cmd">
        <div class="heading-row">
          <h3>คำสั่งในคอมมานบล็อก</h3>
          <button class="copy-section-btn" data-target="cmdBlockCommands">คัดลอก
            <span class="flash" aria-hidden="true"></span>
          </button>
        </div>
        <p class="lead">คำสั่งที่จะใส่ในคอมมานบล็อก</p>
        <div class="codewrap">
<pre id="cmdBlockCommands" class="cmd">
dialogue open @e[type=npc,tag=b] @a[tag=b]
scoreboard players add @a m 0
execute as @a at @s run titleraw @s actionbar {"rawtext":[{"text":"§6Money  §r : "},{"score":{"name":"@s","objective":"m"}}]}
</pre>
        </div>
      </section>

      <section class="section" data-cat="npc" id="sec-npc">
        <div class="heading-row">
          <h3>คำสั่งใน NPC (ตัวหลัก & ตัวซื้อ)</h3>
          <button class="copy-section-btn" data-target="npcBuy">คัดลอก
            <span class="flash" aria-hidden="true"></span>
          </button>
        </div>
        <p class="lead">แยกเป็น 2 กลุ่ม — ตัวหลักพูดคุยและตัวซื้อ</p>
        <div class="codewrap">
<pre id="npcMain" class="cmd">
/tag @initiator add b
</pre>

<pre id="npcBuy" class="cmd">
playsound mob.villager.no @initiator[scores={m=..19}]
playsound note.harp @initiator[scores={m=..19}]
tellraw @initiator[scores={m=..19}] {"rawtext":[{"text":" §eคนขายของ§r: §cซื้อไม่สำเร็จ§r"}]}

playsound mob.villager.yes @initiator[scores={m=20..}]
playsound note.bell @initiator[scores={m=20..}]
tellraw @initiator[scores={m=20..}] {"rawtext":[{"text":" §eคนขายของ§r: §aซื้อสำเร็จ§r"}]}

give @initiator[scores={m=20..}] wooden_sword 1
scoreboard players remove @initiator[scores={m=20..}] m 20

/tag @initiator remove b
</pre>
        </div>
      </section>

      <footer>© MC Command Bedrock — By Pain</footer>
    </main>
  </div>

  <script>
  (function(){
    /* Element refs */
    const hamb = document.getElementById('mcHamb');
    const sidebar = document.getElementById('mcSidebar');
    const overlay = document.getElementById('mcOverlay');
    const closeBtn = document.getElementById('mcClose');
    const search = document.getElementById('mcSearch');
    const filter = document.getElementById('mcFilter');
    const downloadBtn = document.getElementById('mcDownload');
    const copyAllBtn = document.getElementById('mcCopyAll');

    /* Open / Close sidebar safely (no global body changes) */
    function openSidebar(){
      sidebar.classList.add('open');
      overlay.classList.add('show');
      sidebar.setAttribute('aria-hidden','false');
      overlay.setAttribute('aria-hidden','false');
      // do not change document.body overflow — keeps other systems untouched
    }
    function closeSidebar(){
      sidebar.classList.remove('open');
      overlay.classList.remove('show');
      sidebar.setAttribute('aria-hidden','true');
      overlay.setAttribute('aria-hidden','true');
    }

    if(hamb) hamb.addEventListener('click', ()=> sidebar.classList.contains('open') ? closeSidebar() : openSidebar());
    if(closeBtn) closeBtn.addEventListener('click', closeSidebar);
    if(overlay) overlay.addEventListener('click', closeSidebar);
    document.addEventListener('keydown', (ev)=> { if(ev.key === 'Escape') closeSidebar(); });

    /* Search & filter */
    const sections = Array.from(document.querySelectorAll('section.section'));
    function applyFilter(){
      const q = (search && search.value) ? search.value.trim().toLowerCase() : '';
      const cat = (filter && filter.value) ? filter.value : 'all';
      sections.forEach(sec=>{
        const catMatch = (cat === 'all') || (sec.dataset.cat === cat);
        const text = (sec.innerText || '').toLowerCase();
        const qMatch = q === '' || text.indexOf(q) !== -1;
        sec.style.display = (catMatch && qMatch) ? '' : 'none';
      });
    }
    if(search) search.addEventListener('input', applyFilter);
    if(filter) filter.addEventListener('change', applyFilter);
    applyFilter();

    /* Command extraction — only copy real commands (no numbering, no hints) */
    const cmdKeywords = ['give','playsound','tellraw','scoreboard','tag','execute','tickingarea','dialogue','summon','title','titleraw','function','setblock','fill','clone','say','spawn','tp','teleport','particle','effect','setworldspawn','give','scoreboard','playsound'];
    function isCommandLine(line){
      if(!line) return false;
      const t = line.trim();
      if(t.startsWith('/')) return true;
      const first = t.split(/\s+/)[0].replace(/[^a-zA-Z0-9_.:-]/g,'').toLowerCase();
      return cmdKeywords.includes(first);
    }
    function extractCommands(text){
      const out = [];
      text.split(/\r?\n/).forEach(raw=>{
        let s = raw.replace(/^\s*\d+\.\s*/,'').trim(); // remove leading numbers
        if(!s) return;
        // strip trailing parenthetical hints like (ตัวหลักพูดคุย)
        s = s.replace(/\s*\(.*\)\s*$/,'').trim();
        if(isCommandLine(s)) out.push(s);
      });
      return out;
    }

    /* Collect visible commands (for download & copy all) */
    function collectVisibleCommands(){
      const visible = Array.from(document.querySelectorAll('section.section'))
        .filter(s => s.style.display !== 'none')
        .map(s => {
          const h = s.querySelector('h3') ? s.querySelector('h3').innerText.trim() : '';
          const pre = s.querySelector('pre.cmd');
          const content = pre ? pre.innerText.trim() : '';
          const cmds = extractCommands(content);
          return (h ? h + '\n' : '') + (cmds.length ? cmds.join('\n') : content);
        }).filter(Boolean);
      return visible.join('\n\n---\n\n');
    }

    /* Download (create text blob of visible commands) */
    if(downloadBtn){
      downloadBtn.addEventListener('click', ()=>{
        const text = collectVisibleCommands();
        if(!text){ alert('ไม่มีคำสั่งที่มองเห็นเพื่อดาวน์โหลด'); return; }

        // visual feedback
        downloadBtn.classList.add('pressed');
        const flash = downloadBtn.querySelector('.flash');
        if(flash){ flash.classList.add('show'); setTimeout(()=> flash.classList.remove('show'), 260); }
        setTimeout(()=> downloadBtn.classList.remove('pressed'), 200);

        const blob = new Blob([text], {type:'text/plain;charset=utf-8'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'mc-commands-by-pain.txt';
        document.body.appendChild(a);
        a.click();
        a.remove();
        setTimeout(()=> URL.revokeObjectURL(url), 1500);
      });
    }

    /* Copy all visible */
    if(copyAllBtn){
      copyAllBtn.addEventListener('click', async ()=>{
        const text = collectVisibleCommands();
        if(!text){ alert('ไม่มีคำสั่งที่มองเห็นให้คัดลอก'); return; }
        try{
          await navigator.clipboard.writeText(text);
          const orig = copyAllBtn.innerText;
          copyAllBtn.innerText = 'คัดลอกแล้ว';
          copyAllBtn.classList.add('pressed');
          setTimeout(()=> { copyAllBtn.innerText = orig; copyAllBtn.classList.remove('pressed'); }, 1200);
        }catch(e){
          alert('คัดลอกไม่สำเร็จ — เบราเซอร์นี้ไม่รองรับการคัดลอกอัตโนมัติ');
        }
      });
    }

    /* Per-section copy buttons */
    document.querySelectorAll('.copy-section-btn').forEach(btn=>{
      btn.addEventListener('click', async ()=>{
        const target = btn.getAttribute('data-target');
        const pre = document.getElementById(target);
        if(!pre){ alert('ไม่พบข้อมูลที่จะคัดลอก'); return; }
        const raw = pre.innerText || '';
        const cmds = extractCommands(raw);
        const copyText = cmds.length ? cmds.join('\n') : raw.trim();
        if(!copyText){ alert('หมวดนี้ไม่มีคำสั่งให้คัดลอก'); return; }

        // visual
        btn.classList.add('pressed');
        const flash = btn.querySelector('.flash');
        if(flash){ flash.classList.add('show'); setTimeout(()=> flash.classList.remove('show'), 220); }
        setTimeout(()=> btn.classList.remove('pressed'), 180);

        try{
          await navigator.clipboard.writeText(copyText);
          const old = btn.innerText;
          btn.innerText = 'คัดลอกแล้ว';
          setTimeout(()=> btn.innerText = old, 1100);
        }catch(e){
          alert('คัดลอกไม่สำเร็จ — เบราเซอร์นี้ไม่รองรับการคัดลอกอัตโนมัติ');
        }
      });
    });

    /* small click feedback for pre blocks */
    document.querySelectorAll('pre.cmd').forEach(pre=>{
      pre.addEventListener('click', ()=> {
        pre.style.background = 'rgba(255,255,255,0.01)';
        pre.style.border = '1px solid rgba(255,255,255,0.03)';
        setTimeout(()=>{ pre.style.background = ''; pre.style.border = ''; }, 200);
      });
    });

    /* initial filter */
    applyFilter();
  })();
  </script>
</body>
      </html>
